
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Satellite-based monitoring of dry and wet conditions using Standardized Precipitation Index (SPI)">
      
      
      
      
        <link rel="canonical" href="https://wfpidn.github.io/SPI/spi/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>4. Calculate SPI - Standardized Precipitation Index</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      

  


  

  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-R04LC6RC6R"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-R04LC6RC6R",{page_path:t.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R04LC6RC6R"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#4-calculate-spi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Standardized Precipitation Index" class="md-header__button md-logo" aria-label="Standardized Precipitation Index" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Standardized Precipitation Index
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              4. Calculate SPI
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/wfpidn/SPI/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    wfpidn/SPI
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Standardized Precipitation Index" class="md-nav__button md-logo" aria-label="Standardized Precipitation Index" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Standardized Precipitation Index
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/wfpidn/SPI/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    wfpidn/SPI
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../background/" class="md-nav__link">
        Background
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          How-to?
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How-to?" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          How-to?
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../directory/" class="md-nav__link">
        0. Working directory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../software/" class="md-nav__link">
        1. Software requirements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pyenv/" class="md-nav__link">
        2. Configure the python environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rainfall/" class="md-nav__link">
        3. Preparing input for SPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../imergnc/" class="md-nav__link">
        3.1 IMERG monthly netCDF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../chirpstif/" class="md-nav__link">
        3.2. CHIRPS monthly GeoTIFF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../chirpsnc/" class="md-nav__link">
        3.3 CHIRPS monthly netCDF
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          4. Calculate SPI
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        4. Calculate SPI
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#imerg-data" class="md-nav__link">
    IMERG data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chirps-data" class="md-nav__link">
    CHIRPS data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-processing" class="md-nav__link">
    Time processing
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../update/" class="md-nav__link">
        5. Update procedure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vizualisation/" class="md-nav__link">
        6. Visualize the result using Panoply
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../conversion/" class="md-nav__link">
        7. Convert the result to GeoTIFF
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Example and References
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Example and References" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Example and References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../output/" class="md-nav__link">
        Example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../references/" class="md-nav__link">
        References
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/wfpidn/SPI/edit/master/docs/spi.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="4-calculate-spi">4. Calculate SPI</h1>
<p>Let's start the calculation!</p>
<ul>
<li>Deactivate an active environment <code>gis</code> then activate environment <code>climate_indices</code> to start working on SPI calculation.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>conda deactivate <span class="o">&amp;&amp;</span> conda activate climate_indices
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please make sure the input file are following input requirements for SPI</p>
<ul>
<li>Variable name on precipitation <code>--var_name_precip</code>, usually IMERG data use <code>precipitation</code> as name while CHIRPS using <code>precip</code>. To make sure, check using command <code>ncdump -h file.nc</code> then adjust it in SPI script if needed.</li>
<li>Precipitation unit must be written as <code>millimeters</code>, <code>milimeter</code>, <code>mm</code>, <code>inches</code>, <code>inch</code> or <code>in</code>.</li>
<li>Data dimension and order must be written as <code>lat</code>, <code>lon</code>, <code>time</code> (Windows machine required this order) or <code>time</code>, <code>lat</code>, <code>lon</code> (Works tested on Mac/Linux and Linux running on WSL).</li>
</ul>
</div>
<h2 id="imerg-data">IMERG data</h2>
<ul>
<li>
<p>Navigate your Terminal to folder <code>Input_nc</code></p>
</li>
<li>
<p>In order to pre-compute fitting parameters for later use as inputs to subsequent SPI calculations, I can save both gamma and Pearson distribution fitting parameters to NetCDF, and later use this file as input for SPI calculations over the same calibration period.</p>
<p>Make sure you check below information:</p>
<ul>
<li>Input file <code>java_cli_imerg_1months_2000_2020.nc</code> available at <code>Input_nc</code> folder. Example: <code>/Users/bennyistanto/Temp/IMERG/Java/Input_nc/</code> </li>
<li>Output folder named <code>Output_nc</code> to save SPI result is exist in your working directory</li>
<li>Output folder named <code>Fitting</code> to store fitting result is exist in your working directory</li>
<li>Variable name is <code>precipitation</code></li>
</ul>
</li>
</ul>
<p>In your Terminal, run the following code.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>spi --periodicity monthly --scales <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">6</span> <span class="m">9</span> <span class="m">12</span> <span class="m">24</span> <span class="m">36</span> <span class="m">48</span> <span class="m">60</span> <span class="m">72</span> --calibration_start_year <span class="m">2000</span> --calibration_end_year <span class="m">2020</span> --netcdf_precip /Users/bennyistanto/Temp/IMERG/SPI/Java/Input_nc/java_cli_imerg_1months_2000_2020.nc --var_name_precip precipitation --output_file_base /Users/bennyistanto/Temp/IMERG/SPI/Java/Output_nc/java_IMERG --multiprocessing all --save_params /Users/bennyistanto/Temp/IMERG/SPI/Java/Fitting/java_IMERG_fitting.nc --overwrite
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Above code is example for calculating SPI 1 to 72-months. It's ok if you think you only need some of them. Example: you are interested to calculate SPI 1 - 3-months, then adjust above code into <code>--scales 1 2 3</code> </p>
</div>
<p><img alt="IMERG SPI" src="../img/imerg-spi.png" /></p>
<p>The above command will compute SPI (standardized precipitation index, both gamma and Pearson Type III distributions) from an input precipitation dataset (in this case, IMERG precipitation dataset). The input dataset is monthly rainfall accumulation data and the calibration period used will be Jun-2000 through Dec-2020. The index will be computed at <code>1</code>,<code>2</code>,<code>3</code>,<code>6</code>,<code>9</code>,<code>12</code>,<code>24</code>,<code>36</code>,<code>48</code>,<code>60</code> and <code>72-month</code> timescales. The output files will be &lt;<code>out_dir&gt;/java_IMERG_spi_gamma_xx.nc</code>, and <code>&lt;out_dir&gt;/java_IMERG_spi_pearson_xx.nc</code>.</p>
<p>The output files will be:</p>
<p>Gamma</p>
<ol>
<li>1-month: <code>/Output_nc/java_IMERG_spi_gamma_01.nc</code></br></li>
<li>2-month: <code>/Output_nc/java_IMERG_spi_gamma_02.nc</code></br></li>
<li>3-month: <code>/Output_nc/java_IMERG_spi_gamma_03.nc</code></br></li>
<li>6-month: <code>/Output_nc/java_IMERG_spi_gamma_06.nc</code></br></li>
<li>9-month: <code>/Output_nc/java_IMERG_spi_gamma_09.nc</code></br></li>
<li>12-month: <code>/Output_nc/java_IMERG_spi_gamma_12.nc</code></br></li>
<li>24-month: <code>/Output_nc/java_IMERG_spi_gamma_24.nc</code></br></li>
<li>36-month: <code>/Output_nc/java_IMERG_spi_gamma_36.nc</code></br></li>
<li>48-month: <code>/Output_nc/java_IMERG_spi_gamma_48.nc</code></br></li>
<li>60-month: <code>/Output_nc/java_IMERG_spi_gamma_60.nc</code></br></li>
<li>72-month: <code>/Output_nc/java_IMERG_spi_gamma_72.nc</code></br></li>
</ol>
<p>Pearson</p>
<ol>
<li>1-month: <code>/Output_nc/java_IMERG_spi_pearson_01.nc</code></br></li>
<li>2-month: <code>/Output_nc/java_IMERG_spi_pearson_02.nc</code></br></li>
<li>3-month: <code>/Output_nc/java_IMERG_spi_pearson_03.nc</code></br></li>
<li>6-month: <code>/Output_nc/java_IMERG_spi_pearson_06.nc</code></br></li>
<li>9-month: <code>/Output_nc/java_IMERG_spi_pearson_09.nc</code></br></li>
<li>12-month: <code>/Output_nc/java_IMERG_spi_pearson_12.nc</code></br></li>
<li>24-month: <code>/Output_nc/java_IMERG_spi_pearson_24.nc</code></br></li>
<li>36-month: <code>/Output_nc/java_IMERG_spi_pearson_36.nc</code></br></li>
<li>48-month: <code>/Output_nc/java_IMERG_spi_pearson_48.nc</code></br></li>
<li>60-month: <code>/Output_nc/java_IMERG_spi_pearson_60.nc</code></br></li>
<li>72-month: <code>/Output_nc/java_IMERG_spi_pearson_72.nc</code></br></li>
</ol>
<p>Parallelization will occur utilizing all CPUs.</p>
<h2 id="chirps-data">CHIRPS data</h2>
<ul>
<li>To make sure everything is correct and following above specifications, in your Terminal - navigate to your directory where you save <code>java_cli_chirps_1months_1981_2020.nc</code> file: <code>Input_nc</code>. Then type</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>ncdump -h java_cli_chirps_1months_1981_2020.nc
</code></pre></div>
<p><img alt="SPI_based_on_CHIRPS_GeoTIFF_03" src="../img/SPI_based_on_CHIRPS_GeoTIFF_03.png" /></p>
<p>From above picture, I can say:</p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Time dimension is enabled, <code>480</code> is total months from Jan 1981 to Dec 2020</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Data dimension and order are following the specification <code>time</code>, <code>lat</code>, <code>lon</code></li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> The unit is in <code>mm</code></li>
</ul>
<p>So, everything is correct and I am ready to calculate SPI. Make sure in your Terminal still inside <code>climate_indices</code> environment.</p>
<p>Other requirements and options related to the indices calculation, please follow https://climate-indices.readthedocs.io/en/latest/#indices-processing</p>
<ul>
<li>
<p>In order to pre-compute fitting parameters for later use as inputs to subsequent SPI calculations I can save both gamma and Pearson distribution fitting parameters to NetCDF, and later use this file as input for SPI calculations over the same calibration period.</p>
<p>Make sure you check below information:</p>
<ul>
<li>Input file <code>java_cli_chirps_1months_1981_2021.nc</code> available at <code>Input_nc</code> folder. Example: <code>/Users/bennyistanto/Temp/CHIRPS/Java/Input_nc/</code> </li>
<li>Output folder named <code>Output_nc</code> to save SPI result is exist in your working directory</li>
<li>Output folder named <code>Fitting</code> to store fitting result is exist in your working directory</li>
<li>Variable name is <code>precip</code></li>
</ul>
</li>
</ul>
<p>In your Terminal, run the following code.</p>
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span>spi --periodicity monthly --scales <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">6</span> <span class="m">9</span> <span class="m">12</span> <span class="m">24</span> <span class="m">36</span> <span class="m">48</span> <span class="m">60</span> <span class="m">72</span> --calibration_start_year <span class="m">1981</span> --calibration_end_year <span class="m">2020</span> --netcdf_precip /Users/bennyistanto/Temp/CHIRPS/SPI/Java/Input_nc/java_cli_chirps_1months_1981_2021.nc --var_name_precip precip --output_file_base /Users/bennyistanto/Temp/CHIRPS/SPI/Java/Output_nc/java_CHIRPS --multiprocessing all --save_params /Users/bennyistanto/Temp/CHIRPS/SPI/Java/Fitting/java_CHIRPS_fitting.nc --overwrite
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Above code is example for calculating SPI 1 to 72-months. It's ok if you think you only need some of them. Example: you are interested to calculate SPI 1 - 3-months, then adjust above code into <code>--scales 1 2 3</code> </p>
</div>
<p><img alt="SPI_based_on_CHIRPS_GeoTIFF_04" src="../img/SPI_based_on_CHIRPS_GeoTIFF_04.png" /></p>
<p>The above command will compute SPI (standardized precipitation index, both gamma and Pearson Type III distributions) from an input precipitation dataset (in this case, CHIRPS precipitation dataset). The input dataset is monthly rainfall accumulation data and the calibration period used will be Jan-1981 through Dec-2020. The index will be computed at <code>1</code>,<code>2</code>,<code>3</code>,<code>6</code>,<code>9</code>,<code>12</code>,<code>24</code>,<code>36</code>,<code>48</code>,<code>60</code> and <code>72-month</code> timescales. The output files will be &lt;<code>out_dir&gt;/java_CHIRPS_spi_gamma_xx.nc</code>, and <code>&lt;out_dir&gt;/java_CHIRPS_spi_pearson_xx.nc</code>.</p>
<p>The output files will be:</p>
<p>Gamma</p>
<ol>
<li>1-month: <code>/Output_nc/java_CHIRPS_spi_gamma_01.nc</code></br></li>
<li>2-month: <code>/Output_nc/java_CHIRPS_spi_gamma_02.nc</code></br></li>
<li>3-month: <code>/Output_nc/java_CHIRPS_spi_gamma_03.nc</code></br></li>
<li>6-month: <code>/Output_nc/java_CHIRPS_spi_gamma_06.nc</code></br></li>
<li>9-month: <code>/Output_nc/java_CHIRPS_spi_gamma_09.nc</code></br></li>
<li>12-month: <code>/Output_nc/java_CHIRPS_spi_gamma_12.nc</code></br></li>
<li>24-month: <code>/Output_nc/java_CHIRPS_spi_gamma_24.nc</code></br></li>
<li>36-month: <code>/Output_nc/java_CHIRPS_spi_gamma_36.nc</code></br></li>
<li>48-month: <code>/Output_nc/java_CHIRPS_spi_gamma_48.nc</code></br></li>
<li>60-month: <code>/Output_nc/java_CHIRPS_spi_gamma_60.nc</code></br></li>
<li>72-month: <code>/Output_nc/java_CHIRPS_spi_gamma_72.nc</code></br></li>
</ol>
<p>Pearson</p>
<ol>
<li>1-month: <code>/Output_nc/java_CHIRPS_spi_pearson_01.nc</code></br></li>
<li>2-month: <code>/Output_nc/java_CHIRPS_spi_pearson_02.nc</code></br></li>
<li>3-month: <code>/Output_nc/java_CHIRPS_spi_pearson_03.nc</code></br></li>
<li>6-month: <code>/Output_nc/java_CHIRPS_spi_pearson_06.nc</code></br></li>
<li>9-month: <code>/Output_nc/java_CHIRPS_spi_pearson_09.nc</code></br></li>
<li>12-month: <code>/Output_nc/java_CHIRPS_spi_pearson_12.nc</code></br></li>
<li>24-month: <code>/Output_nc/java_CHIRPS_spi_pearson_24.nc</code></br></li>
<li>36-month: <code>/Output_nc/java_CHIRPS_spi_pearson_36.nc</code></br></li>
<li>48-month: <code>/Output_nc/java_CHIRPS_spi_pearson_48.nc</code></br></li>
<li>60-month: <code>/Output_nc/java_CHIRPS_spi_pearson_60.nc</code></br></li>
<li>72-month: <code>/Output_nc/java_CHIRPS_spi_pearson_72.nc</code></br></li>
</ol>
<p>Parallelization will occur utilizing all CPUs.</p>
<h2 id="time-processing">Time processing</h2>
<p>For small area of interest, the calculation will fast and don’t take much time. Below is one of example if you processed bigger area:</p>
<ul>
<li>
<p>Monthly IMERG data, global coverage 180W - 180E, 60N - 60S, 0.1 deg spatial resolution. It takes almost 9-hours to process SPI 1-72 months.</p>
<p><img alt="SPI_based_on_CHIRPS_GeoTIFF_05" src="../img/SPI_based_on_CHIRPS_GeoTIFF_05.png" /></p>
<p>Output gamma and pearson file <a href="https://github.com/wfpidn/SPI/blob/master/Data/Output_nc">https://github.com/wfpidn/SPI/blob/master/Data/Output_nc</a></p>
<p>Fitting file <a href="https://github.com/wfpidn/SPI/blob/master/Data/Fitting">https://github.com/wfpidn/SPI/blob/master/Data/Fitting</a></p>
</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../chirpsnc/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 3.3 CHIRPS monthly netCDF" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              3.3 CHIRPS monthly netCDF
            </div>
          </div>
        </a>
      
      
        
        <a href="../update/" class="md-footer__link md-footer__link--next" aria-label="Next: 5. Update procedure" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              5. Update procedure
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.1e84347e.min.js"></script>
      
        <script src="../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>